@using WebApp.Models
@model WebApp.Models.SearchData

@{
    ViewBag.Title = "GetResults";
    Layout = "~/Views/Shared/_Layout.cshtml";

    var resList = Model.ResultList as List<WebApp.Models.Documents.ReportDocument>;
    var count = 5;
    count = resList.Count();
    int p = 0;
}

<head>
    <style type="text/css">
        table {
            width: 100%;
            border-collapse: collapse;
        }

        .scrollingTable {
            overflow-y: auto;
        }
        input {
            border: 0;
        }
        summary {
            width: 300%;
        }
    </style>
    <script type="text/javascript">
        var mod = @Html.Raw(Json.Encode(Model));

        function updateSummary(id) {
            @*document.getElementById('testTb').value = mod.ResultList[id-1].Summary;*@
            var summary = "";

            var i;
            for (i = 0; i < mod.ResultList.length; i++) {
                if (mod.ResultList[i].Id == id) {
                    summary = mod.ResultList[i].Summary;
                }
            }
            document.getElementById('summaryTb').value = summary;
        }

        function makeTableScroll() {
            // Constant retrieved from server-side via JSP
            var maxRows = 10;
            var table = document.getElementById('ResultTable');
            var wrapper = table.parentNode;
            var rowsInTable = table.rows.length;
            var height = 0;
            if (rowsInTable > maxRows) {
                for (var i = 0; i < maxRows; i++) {
                    height += table.rows[i].clientHeight;
                }
                wrapper.style.height = height + "px";
            }
        }
    </script>
</head>


<h2>Results</h2>

<body onload="makeTableScroll();">
    <div class="scrollingTable">
        <table id="ResultTable" class="fixed_headers">
            <thead>
                <tr>
                    @foreach (var header in WebApp.Models.SearchData.HeaderList)
                    {
                        <th>
                            @Html.DisplayFor(modelItem => header)
                        </th>
                    }
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.ResultList)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.Id)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Name)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Author)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Keywords)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Date)
                        </td>
                        <td>
                            <a href="#" id=@item.Id onclick="updateSummary(this.id)"> Summary </a>
                        </td>
                        <td>
                            @Html.ActionLink("Download", "Index", new { id = item.Id })
                        </td>
                    </tr>
                }
            </tbody>

        </table>
    </div>
    <div class="summary">
        <form>
            <br />
            <br />
            <h3>Summary</h3>

            <h5>
                <input type="text" value="" readonly="readonly" id="summaryTb" class="summary" /><br />
                <input type="text" value="" readonly="readonly" id="testTb" class="summary" />
            </h5>
        </form>
        
    </div>
    


</body>


@using WebApp.Models
@model WebApp.Models.SearchData
@using WebApp.Content

@{
    /**/

    ViewBag.Title = "GetResults";
    Layout = "~/Views/Shared/_Layout.cshtml";

    var resList = Model.ResultList as List<WebApp.Models.Documents.ReportDocument>;
    var count = 5;
    count = resList.Count();
    
}

<head>
    <style type="text/css">
        table {
            width: 100%;
            border-collapse: collapse;
        }

        .scrollingTable {
            overflow-y: auto;
        }

        input {
            border: 0;
        }

        summary {
            width: 300%;
        }
    </style>
    <script type="text/javascript">
        var mod = @Html.Raw(Json.Encode(Model));

        function updateSummary(id) {
            @*document.getElementById('testTb').value = mod.ResultList[id-1].Summary;*@
            var summary = "";

            var i;
            for (i = 0; i < mod.ResultList.length; i++) {
                if (mod.ResultList[i].Id == id) {
                    summary = mod.ResultList[i].Summary;
                }
            }
            document.getElementById('summaryTb').value = summary;
        }

        function makeTableScroll() {
            // Constant retrieved from server-side via JSP
            var maxRows = 10;
            var table = document.getElementById('ResultTable');
            var wrapper = table.parentNode;
            var rowsInTable = table.rows.length;
            var height = 0;
            if (rowsInTable > maxRows) {
                for (var i = 0; i < maxRows; i++) {
                    height += table.rows[i].clientHeight;
                }
                wrapper.style.height = height + "px";
            }
        }
    </script>
</head>


<body onload="makeTableScroll();">
    <div class="jumbotron">
        <div class="h4 pb-3">Results</div>
        <div class="scrollingTable">
            <table id="ResultTable" class="fixed_headers">
                <thead>
                    <tr>
                        @foreach (var header in WebApp.Models.SearchData.HeaderList)
                        {
                            <th>
                                @Html.DisplayFor(modelItem => header)
                            </th>
                        }
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.ResultList)
                    {
                        <tr>
                            <td>
                                @Html.DisplayFor(modelItem => item.Name)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Author)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Date.Date)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Keywords)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Publisher)
                            </td>
                            <td>
                                <a href="#" id=@item.Id onclick="updateSummary(this.id)"> Summary </a>
                            </td>
                            <td>
                                @Html.ActionLink("Download", "Index", new { id = item.Id })
                            </td>
                        </tr>
                    }
                </tbody>

            </table>
        </div>
        <div>
            <form>
                <br />
                <br />
                <div class="h4 pb-3">Summary</div>
                <textarea id="summaryTb" value="" readonly="readonly" rows="10" cols="50" wrap="soft"></textarea>

                
                <br />

            </form>

        </div>


    </div>
</body>

